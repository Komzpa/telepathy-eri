From d1cfe821e65034054144b4bd94631b4d58190508 Mon Sep 17 00:00:00 2001
From: Igor Gnatenko <i.gnatenko.brain@gmail.com>
Date: Sun, 6 Oct 2013 14:43:03 +0400
Subject: [PATCH] fix pending messages

Reported-by: Aleksandr Stepanov
Signed-off-by: Igor Gnatenko <i.gnatenko.brain@gmail.com>
---
 src/server/channel.py | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/src/server/channel.py b/src/server/channel.py
index 3896db5..4215521 100644
--- a/src/server/channel.py
+++ b/src/server/channel.py
@@ -483,7 +483,7 @@ class ChannelInterfaceMessages(_ChannelInterfaceMessages):
     _supported_content_types = []
     _message_types = [CHANNEL_TEXT_MESSAGE_TYPE_NORMAL]
     _message_part_support_flags = 0
-    _pending_messages = {}
+    _pending_IM_messages = {}
     _delivery_reporting_support = 0
 
     def __init__(self):
@@ -512,7 +512,7 @@ class ChannelInterfaceMessages(_ChannelInterfaceMessages):
         return self._message_part_support_flags
 
     def _get_pending_messages(self):
-        return self._pending_messages.values()
+        return self._pending_IM_messages.values()
 
     def _get_delivery_reporting_support(self):
         return self._delivery_reporting_support
@@ -520,4 +520,4 @@ class ChannelInterfaceMessages(_ChannelInterfaceMessages):
     @dbus.service.signal(CHANNEL_INTERFACE_MESSAGES, signature='aa{sv}')
     def MessageReceived(self, message):
         id = message[0]['pending-message-id']
-        self._pending_messages[id] = dbus.Array(message, signature='a{sv}')
+        self._pending_IM_messages[id] = dbus.Array(message, signature='a{sv}')
-- 
1.8.3.1

